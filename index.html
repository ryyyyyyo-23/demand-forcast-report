<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥åˆ¥éœ€è¦äºˆæ¸¬ 2025å¹´9-12æœˆ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            background: #ffffff;
            padding: 20px;
            color: #37352f;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: #37352f;
        }
        
        .subtitle {
            color: #787774;
            font-size: 1rem;
        }
        
        .section {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 24px;
        }
        
        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #37352f;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 20px;
        }
        
        .chart-container-small {
            height: 250px;
        }
        
        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
            padding: 16px;
            background: #f7f6f3;
            border-radius: 6px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.875rem;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }
        
        th {
            background: #f7f6f3;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 1px solid #e0e0e0;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        tr:hover {
            background: #fafafa;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .status-high {
            background: #ffebee;
            color: #c62828;
        }
        
        .status-medium {
            background: #fff3e0;
            color: #ef6c00;
        }
        
        .status-normal {
            background: #e3f2fd;
            color: #1565c0;
        }
        
        .progress-bar {
            background: #e0e0e0;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: #2e7d32;
            transition: width 0.3s ease;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š æ—¥åˆ¥éœ€è¦äºˆæ¸¬</h1>
            <div class="subtitle">2025å¹´9æœˆ-12æœˆ | éœ€è¦äºˆæ¸¬ Ã— ãƒ–ãƒƒã‚­ãƒ³ã‚°ã‚«ãƒ¼ãƒ–åˆ†æ | 2025å¹´9æœˆ17æ—¥æ›´æ–°</div>
        </div>
        
        <div class="section">
            <h2 class="section-title">ğŸ“ˆ æ—¥åˆ¥éœ€è¦äºˆæ¸¬ Ã— ç¾åœ¨äºˆç´„çŠ¶æ³ï¼ˆOHï¼‰</h2>
            <div class="legend-grid">
                <div class="legend-item">
                    <div class="legend-color" style="background: rgba(54, 162, 235, 0.8);"></div>
                    <span>ç¾åœ¨OHï¼ˆäºˆç´„æ¸ˆã¿ï¼‰</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: rgba(255, 99, 132, 0.3);"></div>
                    <span>è¿½åŠ äºˆç´„è¦‹è¾¼ã¿</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: rgba(75, 192, 192, 1);"></div>
                    <span>æœ€çµ‚äºˆæƒ³ç¨¼åƒç‡</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: rgba(255, 206, 86, 1);"></div>
                    <span>æ¨å¥¨ADRï¼ˆå³è»¸ï¼‰</span>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="integratedChart"></canvas>
            </div>
        </div>
        
        <div class="two-column">
            <div class="section">
                <h2 class="section-title">ğŸ“Š ãƒ–ãƒƒã‚­ãƒ³ã‚°ã‚«ãƒ¼ãƒ–é€²æ—</h2>
                <div class="chart-container chart-container-small">
                    <canvas id="bookingCurveChart"></canvas>
                </div>
            </div>
            
            <div class="section">
                <h2 class="section-title">ğŸ“… æœˆåˆ¥OH vs æœ€çµ‚äºˆæƒ³</h2>
                <div class="chart-container chart-container-small">
                    <canvas id="monthlyChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2 class="section-title">ğŸ¯ é‡è¦æ—¥ã®ä¾¡æ ¼æˆ¦ç•¥</h2>
            <table>
                <thead>
                    <tr>
                        <th>æœŸé–“</th>
                        <th>ã‚¤ãƒ™ãƒ³ãƒˆ</th>
                        <th>ç¾åœ¨OH</th>
                        <th>äºˆæƒ³</th>
                        <th>é€²æ—</th>
                        <th>æ¨å¥¨ADR</th>
                        <th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>9/20-23</strong></td>
                        <td>ç§‹åˆ†ã®æ—¥4é€£ä¼‘</td>
                        <td>45%</td>
                        <td>85%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 53%; background: #ff9800;"></div>
                            </div>
                        </td>
                        <td><span class="status-badge status-high">Â¥22,000-25,000</span></td>
                        <td>å³æ™‚ä¾¡æ ¼UP</td>
                    </tr>
                    <tr>
                        <td><strong>10/7-13</strong></td>
                        <td>ä¸‡åšæœ€çµ‚é€±</td>
                        <td>48%</td>
                        <td>95%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 51%; background: #f44336;"></div>
                            </div>
                        </td>
                        <td><span class="status-badge status-high">Â¥25,000-30,000</span></td>
                        <td>è²©ä¿ƒå¼·åŒ–</td>
                    </tr>
                    <tr>
                        <td><strong>10/11-13</strong></td>
                        <td>ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥é€£ä¼‘</td>
                        <td>48%</td>
                        <td>92%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 52%; background: #f44336;"></div>
                            </div>
                        </td>
                        <td><span class="status-badge status-high">Â¥25,000-28,000</span></td>
                        <td>é«˜ä¾¡æ ¼ç¶­æŒ</td>
                    </tr>
                    <tr>
                        <td><strong>11/1-3</strong></td>
                        <td>æ–‡åŒ–ã®æ—¥é€£ä¼‘</td>
                        <td>18%</td>
                        <td>82%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 22%; background: #4caf50;"></div>
                            </div>
                        </td>
                        <td><span class="status-badge status-medium">Â¥20,000-23,000</span></td>
                        <td>è¨ˆç”»é€šã‚Š</td>
                    </tr>
                    <tr>
                        <td><strong>11/22-24</strong></td>
                        <td>å‹¤åŠ´æ„Ÿè¬ã®æ—¥é€£ä¼‘</td>
                        <td>12%</td>
                        <td>80%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 15%; background: #4caf50;"></div>
                            </div>
                        </td>
                        <td><span class="status-badge status-medium">Â¥20,000-23,000</span></td>
                        <td>æ—©å‰²å±•é–‹</td>
                    </tr>
                    <tr>
                        <td><strong>12/27-1/4</strong></td>
                        <td>å¹´æœ«å¹´å§‹</td>
                        <td>8%</td>
                        <td>90%</td>
                        <td>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 9%; background: #4caf50;"></div>
                            </div>
                        </td>
                        <td><span class="status-badge status-high">Â¥23,000-28,000</span></td>
                        <td>è¶…æ—©å‰²</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // çµ±åˆãƒãƒ£ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
        function generateIntegratedData() {
            const labels = [];
            const currentOH = [];
            const remaining = [];
            const finalOccupancy = [];
            const recommendedADR = [];
            
            const today = new Date(2025, 8, 17); // 9æœˆ17æ—¥
            
            // ä¸»è¦ãªæ—¥ä»˜ã®ã¿è¡¨ç¤ºï¼ˆé€±2å›ç¨‹åº¦ï¼‰
            const displayDates = new Set();
            
            for (let month = 9; month <= 12; month++) {
                const daysInMonth = new Date(2025, month, 0).getDate();
                
                for (let day = 1; day <= daysInMonth; day += 4) {
                    displayDates.add(`${month}/${day}`);
                }
                // æœˆæœ«ã¨é‡è¦æ—¥ã‚’è¿½åŠ 
                displayDates.add(`${month}/${daysInMonth}`);
            }
            
            // é‡è¦æ—¥ã‚‚è¿½åŠ 
            ['9/15', '9/20', '9/23', '10/7', '10/13', '11/3', '11/23', '12/27'].forEach(d => displayDates.add(d));
            
            // ã‚½ãƒ¼ãƒˆã—ã¦é…åˆ—åŒ–
            const sortedDates = Array.from(displayDates).sort((a, b) => {
                const [ma, da] = a.split('/').map(Number);
                const [mb, db] = b.split('/').map(Number);
                return ma === mb ? da - db : ma - mb;
            });
            
            sortedDates.forEach(dateStr => {
                const [month, day] = dateStr.split('/').map(Number);
                const date = new Date(2025, month - 1, day);
                const daysUntil = Math.floor((date - today) / (1000 * 60 * 60 * 24));
                
                labels.push(dateStr);
                
                // ãƒ–ãƒƒã‚­ãƒ³ã‚°ã‚«ãƒ¼ãƒ–ã«åŸºã¥ãé€²æ—ç‡
                let progress = 0;
                if (daysUntil <= 0) progress = 0.95;
                else if (daysUntil <= 3) progress = 0.88;
                else if (daysUntil <= 7) progress = 0.80;
                else if (daysUntil <= 14) progress = 0.70;
                else if (daysUntil <= 30) progress = 0.50;
                else if (daysUntil <= 60) progress = 0.25;
                else progress = 0.15;
                
                // æ›œæ—¥ã¨ç‰¹åˆ¥æ—¥ã«ã‚ˆã‚‹æœ€çµ‚äºˆæƒ³
                const weekday = date.getDay();
                const baseOcc = [75, 48, 45, 46, 52, 68, 80][weekday];
                let finalOcc = baseOcc;
                
                // ç‰¹åˆ¥æ—¥ã¨æœˆåˆ¥èª¿æ•´
                const holidays = ['9/15', '9/23', '10/13', '11/3', '11/23'];
                if (holidays.includes(dateStr)) finalOcc *= 1.2;
                if (month === 10) finalOcc *= 1.1; // ä¸‡åšåŠ¹æœ
                if (month === 10 && day >= 7 && day <= 13) finalOcc = 95; // ä¸‡åšæœ€çµ‚é€±
                
                finalOcc = Math.min(95, finalOcc);
                
                const current = Math.round(finalOcc * progress);
                const remain = Math.round(finalOcc - current);
                
                currentOH.push(current);
                remaining.push(remain);
                finalOccupancy.push(Math.round(finalOcc));
                
                // æ¨å¥¨ADRè¨ˆç®—
                let adr = 15000;
                if (finalOcc >= 85) adr = 24000;
                else if (finalOcc >= 75) adr = 20000;
                else if (finalOcc >= 65) adr = 17000;
                
                recommendedADR.push(adr);
            });
            
            return { labels, currentOH, remaining, finalOccupancy, recommendedADR };
        }
        
        const integratedData = generateIntegratedData();
        
        // çµ±åˆãƒãƒ£ãƒ¼ãƒˆ
        const integratedCtx = document.getElementById('integratedChart').getContext('2d');
        new Chart(integratedCtx, {
            type: 'bar',
            data: {
                labels: integratedData.labels,
                datasets: [{
                    type: 'bar',
                    label: 'ç¾åœ¨OH',
                    data: integratedData.currentOH,
                    backgroundColor: 'rgba(54, 162, 235, 0.8)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1,
                    stack: 'stack0',
                    yAxisID: 'y'
                }, {
                    type: 'bar',
                    label: 'è¿½åŠ äºˆç´„è¦‹è¾¼ã¿',
                    data: integratedData.remaining,
                    backgroundColor: 'rgba(255, 99, 132, 0.3)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1,
                    stack: 'stack0',
                    yAxisID: 'y'
                }, {
                    type: 'line',
                    label: 'æœ€çµ‚äºˆæƒ³ç¨¼åƒç‡',
                    data: integratedData.finalOccupancy,
                    borderColor: 'rgba(75, 192, 192, 1)',
                    backgroundColor: 'rgba(75, 192, 192, 0.1)',
                    borderWidth: 3,
                    tension: 0.2,
                    yAxisID: 'y'
                }, {
                    type: 'line',
                    label: 'æ¨å¥¨ADR',
                    data: integratedData.recommendedADR,
                    borderColor: 'rgba(255, 206, 86, 1)',
                    backgroundColor: 'rgba(255, 206, 86, 0.1)',
                    borderWidth: 2,
                    borderDash: [5, 5],
                    yAxisID: 'y1'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    mode: 'index',
                    intersect: false
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            title: function(context) {
                                const label = context[0].label;
                                const [month, day] = label.split('/').map(Number);
                                const date = new Date(2025, month - 1, day);
                                const weekdays = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
                                return `${month}æœˆ${day}æ—¥ï¼ˆ${weekdays[date.getDay()]}ï¼‰`;
                            },
                            afterBody: function(context) {
                                const oh = context[0].parsed.y;
                                const remaining = context[1].parsed.y;
                                const total = oh + remaining;
                                const progress = Math.round((oh / total) * 100);
                                return `\né€²æ—ç‡: ${progress}%`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        stacked: true,
                        grid: {
                            display: false
                        },
                        ticks: {
                            maxRotation: 45,
                            minRotation: 45,
                            font: {
                                size: 10
                            }
                        }
                    },
                    y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        stacked: true,
                        beginAtZero: true,
                        max: 100,
                        title: {
                            display: true,
                            text: 'ç¨¼åƒç‡ (%)'
                        },
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    },
                    y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        beginAtZero: false,
                        min: 10000,
                        max: 30000,
                        title: {
                            display: true,
                            text: 'ADR (å††)'
                        },
                        ticks: {
                            callback: function(value) {
                                return 'Â¥' + value.toLocaleString();
                            }
                        },
                        grid: {
                            drawOnChartArea: false
                        }
                    }
                }
            }
        });
        
        // ãƒ–ãƒƒã‚­ãƒ³ã‚°ã‚«ãƒ¼ãƒ–ãƒãƒ£ãƒ¼ãƒˆ
        const bookingCurveCtx = document.getElementById('bookingCurveChart').getContext('2d');
        new Chart(bookingCurveCtx, {
            type: 'line',
            data: {
                labels: ['90æ—¥å‰', '60æ—¥å‰', '30æ—¥å‰', '14æ—¥å‰', '7æ—¥å‰', '3æ—¥å‰', 'å½“æ—¥'],
                datasets: [{
                    label: 'æ¨™æº–ã‚«ãƒ¼ãƒ–',
                    data: [15, 25, 50, 70, 80, 88, 95],
                    borderColor: '#2e7d32',
                    backgroundColor: 'rgba(46, 125, 50, 0.1)',
                    borderWidth: 2,
                    tension: 0.3
                }, {
                    label: 'ç¾åœ¨ã®é€²æ—',
                    data: [10, 20, 45, 62, 75, 85, null],
                    borderColor: '#1976d2',
                    backgroundColor: 'rgba(25, 118, 210, 0.1)',
                    borderWidth: 2,
                    borderDash: [5, 5],
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                }
            }
        });
        
        // æœˆåˆ¥æ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆ
        const monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
        new Chart(monthlyCtx, {
            type: 'bar',
            data: {
                labels: ['9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'],
                datasets: [{
                    label: 'ç¾åœ¨OH',
                    data: [62, 51, 31, 13],
                    backgroundColor: '#1976d2',
                    borderColor: '#1976d2',
                    borderWidth: 1
                }, {
                    label: 'æœ€çµ‚äºˆæƒ³',
                    data: [82, 85, 75, 68],
                    backgroundColor: 'rgba(255, 152, 0, 0.3)',
                    borderColor: '#ff9800',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>
